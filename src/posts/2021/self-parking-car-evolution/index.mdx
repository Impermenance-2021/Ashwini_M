---
title: "Self-Parking Car Evolution"

summary: "Training the car to do self-parking using a genetic algorithm (and 500 lines of code)"

cover: assets/01-cover-00.jpg

date: 2021-09-16

---

![Self-Parking car evolution](assets/01-cover-01.jpg)

## TL;DR

In this article we'll train the car to do self-parking using a [genetic algorithm](https://en.wikipedia.org/wiki/Genetic_algorithm).

We'll create **the first generation** of cars with random genomes that will behave something like this:

![The 1st generation of cars with random genomes](assets/02-cars-before-01.gif)

**On the ‚âà40th generation** the cars start learning what the self-parking is and start getting closer to the parking spot (although hitting the other cars along the way):

![The 40th generation start learning how to park](assets/03-car-after-01.gif)

Another example with a bit more challenging starting point:

![More challenging starting point for self-parking](assets/03-car-after-03.gif)

You may launch the üöï [Self-parking Car Evolution Simulator](https://trekhleb.dev/self-parking-car-evolution) to see the evolution process directly in you browser. The simulator gives you the following opportunities:

- You may [train the cars from scratch](https://trekhleb.dev/self-parking-car-evolution?parking=evolution#/) and adjust genetic parameters by yourself
- You may [see the trained (almost) self-parking cars in action](https://trekhleb.dev/self-parking-car-evolution?parking=automatic#/)
- You may also [try to park the car manually](https://trekhleb.dev/self-parking-car-evolution?parking=manual#/).

‚ÑπÔ∏è We're going to use a genetic algorithm to evolve cars genomes. However, this article only touches on the basics of the algorithm and is by no means a complete guide to the genetic algorithm topic.

Having that said, let's deep dive into more details...

## Giving the eyes to the car

Before our car will learn how to do self-parking, it needs to be able to "see" the surroundings. Let's give it the `8` "eyes" in a form of distance sensors:

- Each sensor can detect the obstacle in a distance range from `0-4m` (meters).
- Each sensor "reports" the latest information about the obstacles it "sees" to the car every `100ms`.
- Whenever the sensor doesn't "see" any obstacles it "reports" the value of `0`. On the contrary, if the value of the sensor is small but not zero (i.e. `0.01m`) it would mean that the obstacle is really close.

![Car sensors with distances](assets/04-sensors-01.jpg)

You may [use the Evolution Simulator](https://trekhleb.dev/self-parking-car-evolution?parking=manual#/) and try to park the car manually to see how the sensors work.

![Car sensors in action](assets/04-sensors-02.gif)

## Giving the brain to the car

## Evolving the car's brain
